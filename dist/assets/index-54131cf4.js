import{j as s,R as p,S as x,L as m,B as u,c as _,I as b,h as f,i as w,k as v,b as N,d as j,l as g,D as k,C,m as I,r as P,n as E,P as L,o as $,p as R}from"./index-3c767ab5.js";import{C as A}from"./index-3cb16e93.js";import{C as y}from"./index-0ec23e3d.js";import{u as S}from"./useIsElementVisible-d782c51e.js";const z="_container_wjh0j_1",B="_content_wjh0j_4",D="_tips_wjh0j_8",U="_desc_wjh0j_13",H="_btn_group_wjh0j_16",M="_btn_wjh0j_16",V="_outlined_wjh0j_23",l={container:z,content:B,tips:D,desc:U,btn_group:H,btn:M,outlined:V};function F({hasLogin:t}){return s.jsxs(p,{align:"middle",justify:"center",className:l.container,children:[s.jsx("img",{src:"https://cdn.cnbj1.fds.api.mi-img.com/staticsfile/cart/cart-empty.png",alt:"empty cart",draggable:!1}),s.jsxs("div",{className:l.content,children:[s.jsx("div",{className:l.tips,children:"您的购物车还是空的！"}),!t&&s.jsx("div",{className:l.desc,children:"登录后将显示您之前加入的商品"}),s.jsx("div",{className:l.btn_group,children:t?s.jsx(m,{to:"/search",children:s.jsx(u,{className:l.btn,children:"马上去购物"})}):s.jsxs(x,{size:"1rem",children:[s.jsx(m,{to:"/login",children:s.jsx(u,{className:l.btn,children:"立即登录"})}),s.jsx(m,{to:"/search",children:s.jsx(u,{outlined:!0,className:_(l.btn,l.outlined),children:"马上去购物"})})]})})]})]})}const O="_container_j97t8_1",X={container:O},q="_container_16ho4_1",G="_input_16ho4_9",J="_icon_16ho4_17",h={container:q,input:G,icon:J};function K({value:t=1,min:i=0,max:o=Number.MAX_VALUE,onChange:r}){function a(n){n>=i&&n<=o&&(r==null||r(n))}return s.jsxs("div",{className:h.container,children:[s.jsx(b,{type:"i-minus",className:h.icon,onClick:()=>{a(t-1)}}),s.jsx("input",{value:t,type:"number",className:h.input,onChange:n=>{const e=Number(n.target.value);Number.isInteger(e)&&e>0&&a(e)}}),s.jsx(b,{type:"i-plus",className:h.icon,onClick:()=>{a(t+1)}})]})}const Q="_container_y41w0_1",T="_product_list_y41w0_5",W="_product_row_y41w0_8",Y="_title_y41w0_17",Z="_col_check_y41w0_21",ss="_img_y41w0_25",cs="_col_name_y41w0_30",es="_col_price_y41w0_36",ts="_col_num_y41w0_40",ns="_col_total_y41w0_44",os="_value_y41w0_48",as="_col_action_y41w0_51",ls="_icon_y41w0_55",is="_footer_bar_y41w0_60",rs="_fixed_y41w0_71",_s="_link_item_y41w0_75",ds="_danger_y41w0_83",ms="_cart_total_y41w0_86",us="_total_amount_y41w0_92",hs="_btn_order_y41w0_98",js="_disabled_y41w0_103",ps="_btn_tips_y41w0_108",c={container:Q,product_list:T,product_row:W,title:Y,col_check:Z,img:ss,col_name:cs,col_price:es,col_num:ts,col_total:ns,value:os,col_action:as,icon:ls,footer_bar:is,fixed:rs,link_item:_s,danger:ds,cart_total:ms,total_amount:us,btn_order:hs,disabled:js,btn_tips:ps};function xs(){return s.jsxs("div",{className:c.container,children:[s.jsx(bs,{}),s.jsx(Ns,{})]})}function bs(){const t=f(),i=w(),[{allChecked:o,halfChecked:r},{switchCheck:a,removeItem:n}]=v();return s.jsxs("div",{className:c.product_list,children:[s.jsxs(p,{align:"middle",className:_(c.product_row,c.title),children:[s.jsx("div",{className:c.col_check,children:s.jsx(y,{checked:o,indeterminate:!o&&r,onChange:e=>{a(null,e)},children:s.jsx("span",{style:{marginLeft:"1rem"},children:"全选"})})}),s.jsx("div",{className:c.col_name,children:"商品名称"}),s.jsx("div",{className:c.col_price,children:"单价"}),s.jsx("div",{className:c.col_num,children:"数量"}),s.jsx("div",{className:c.col_total,children:"小计"}),s.jsx("div",{className:c.col_action,children:"操作"})]}),t.map(e=>s.jsxs(p,{align:"middle",className:c.product_row,children:[s.jsxs("div",{className:c.col_check,children:[s.jsx(y,{checked:e.checked,onChange:d=>{a(e,d)}}),s.jsx(m,{to:N(e.label),children:s.jsx("img",{alt:e.label,src:e.pictureUrl,className:c.img})})]}),s.jsx("div",{className:_(c.col_name,"text-ellipsis"),children:s.jsx(m,{to:N(e.label),children:e.label})}),s.jsx("div",{className:c.col_price,children:j(e.price)}),s.jsx("div",{className:c.col_num,children:s.jsx(K,{value:e.number,onChange:d=>{d===0?n(e):i(g.actions.modifyProductNumber({label:e.label,number:d}))}})}),s.jsx("div",{className:_(c.col_total,c.value),children:j(new k(e.price).mul(e.number).toNumber())}),s.jsx("div",{className:c.col_action,children:s.jsx(C,{className:c.icon,onClick:()=>{n(e)}})})]},e.label))]})}function Ns(){const t=f(),i=w(),{totalNumber:o,totalAmount:r}=I(),a=P.useRef(null),n=S({elementRef:a,predicate(d){return d.bottom>=window.innerHeight},deps:[t.length]}),e=E();return s.jsxs("div",{ref:a,className:_(c.footer_bar,n&&c.fixed),children:[s.jsxs(x,{size:"1.6rem",split:s.jsx("span",{style:{color:"#eee"},children:"|"}),style:{marginLeft:"2.4rem"},children:[s.jsx(m,{to:"/search",className:c.link_item,children:"继续购物"}),s.jsx("div",{className:_(c.link_item,c.danger),onClick:()=>{L.confirm("确定清空购物车吗？",{onOk(){i(g.actions.clearCart())}})},children:"清空购物车"}),s.jsxs("div",{className:c.cart_total,children:["已选择 ",s.jsx("span",{children:j(o,"")})," 件"]})]}),s.jsxs(x,{size:"5rem",children:[s.jsxs("div",{className:c.total_amount,children:["合计：",s.jsx("span",{children:j(r,"")})," 元"]}),s.jsxs("div",{children:[s.jsx(u,{className:_(c.btn_order,o===0&&c.disabled),onClick:()=>{o>0&&e("/order/checkout")},children:"去结算"}),o===0&&s.jsx(u,{outlined:!0,className:c.btn_tips,children:"请勾选需要结算的商品"})]})]})]})}function vs(){const t=$(),i=R();return s.jsx("div",{style:{backgroundColor:"var(--color-background)"},children:s.jsxs("div",{className:X.container,children:[i?s.jsx(F,{hasLogin:t}):s.jsx(xs,{}),s.jsx(A,{title:t?"为您推荐":"买购物车中商品的人还买了"})]})})}export{vs as default};
