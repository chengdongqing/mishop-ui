import{r as i,j as e,R as d,S as c,B as m,N as x,L as j,y as b,z as r,U as _,X as p,G as f,m as v,P as g}from"./index-3e2d7128.js";import{M as N}from"./index-fb3b6d16.js";import{u as k}from"./useElementVisible-74c7ae6e.js";import{AddressGroup as y}from"./index-f158bd77.js";import"./const-b031e7cd.js";import"./index-7ab2b6ab.js";const w="_container_he21g_1",C="_title_he21g_7",S="_address_list_he21g_13",A="_fixed_header_he21g_16",P="_wrapper_he21g_25",z="_product_list_he21g_32",F="_item_he21g_32",L="_name_he21g_41",R="_price_number_he21g_48",U="_subtotal_he21g_52",B="_shipment_he21g_57",E="_value_he21g_67",G="_bill_infos_he21g_71",I="_label_he21g_78",M="_footer_bar_he21g_84",q="_address_info_he21g_89",H="_btn_he21g_94",V="_btn_back_he21g_98",s={container:w,title:C,address_list:S,fixed_header:A,wrapper:P,product_list:z,item:F,name:L,price_number:R,subtotal:U,shipment:B,value:E,bill_infos:G,label:I,footer_bar:M,address_info:q,btn:H,btn_back:V};function ee(){const[l,n]=i.useState();return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"确认订单"}),e.jsx("div",{style:{padding:"4rem 0 6rem",backgroundColor:"var(--color-background)"},children:e.jsxs("div",{className:s.container,children:[e.jsx(D,{address:l,onChange:n}),e.jsx(T,{}),e.jsx(X,{}),e.jsx(J,{}),e.jsx(K,{address:l})]})})]})}function D({address:l,onChange:n}){const[a,o]=i.useState(),u=i.useRef(null),h=k(u,t=>t.bottom<=0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:u,className:s.address_list,children:[e.jsx("div",{className:s.title,children:"收货地址"}),e.jsx(y,{selectMode:!0,columns:4,value:l==null?void 0:l.id,defaultExpand:!1,onChange:n,onLoaded:o})]}),!l&&!!a&&h&&e.jsx("div",{className:s.fixed_header,children:e.jsxs(d,{align:"middle",justify:"space-between",className:s.wrapper,children:[e.jsxs(c,{size:"2.4rem",children:[e.jsx("span",{children:a.username}),e.jsx("span",{children:a.phoneNumber}),e.jsx("span",{children:a.address.join(" ")})]}),e.jsx(m,{className:s.btn,onClick:()=>{var t;n(a),(t=u.current)==null||t.scrollIntoView({behavior:"smooth"})},children:"选择该收货地址"})]})})]})}function T(){const l=x(!0);return e.jsxs("div",{className:s.product_list,children:[e.jsx("div",{className:s.title,children:"商品信息"}),e.jsx("div",{children:l.map(n=>e.jsxs(d,{align:"middle",className:s.item,children:[e.jsxs(c,{size:"1rem",style:{flex:1},children:[e.jsx("img",{src:n.pictureUrl,alt:n.label}),e.jsx(j,{to:b(n.label),className:s.name,target:"_blank",children:n.label})]}),e.jsxs("div",{className:s.price_number,children:[r(n.price)," x ",n.number]}),e.jsx("div",{className:s.subtotal,children:r(new _(n.price).mul(n.number).toNumber())})]},n.label))})]})}function X(){return e.jsxs(d,{align:"middle",className:s.shipment,children:[e.jsx("div",{className:s.title,children:"配送方式"}),e.jsx("div",{className:s.value,children:"包邮"})]})}function J(){const{totalNumber:l,totalAmount:n}=p(!0);return e.jsx("div",{className:s.bill_infos,children:e.jsxs(f,{columns:2,gap:"0.8rem",style:{alignItems:"end"},children:[e.jsx("div",{className:s.label,children:"商品件数："}),e.jsx("div",{className:s.value,children:r(l,"件")}),e.jsx("div",{className:s.label,children:"商品总价："}),e.jsx("div",{className:s.value,children:r(n)}),e.jsx("div",{className:s.label,children:"优惠金额："}),e.jsxs("div",{className:s.value,children:["-",r(.01)]}),e.jsx("div",{className:s.label,children:"运费："}),e.jsx("div",{className:s.value,children:r(0)}),e.jsx("div",{className:s.label,style:{lineHeight:"3rem"},children:"应付总额："}),e.jsxs("div",{className:s.value,children:[e.jsx("span",{style:{fontSize:"3rem"},children:r(new _(n).sub(.01).toNumber(),"")}),e.jsx("span",{children:" 元"})]})]})})}function K({address:l}){const n=v(),[a,o]=i.useState(!1);return e.jsxs(d,{justify:"space-between",className:s.footer_bar,children:[e.jsx("div",{className:s.address_info,children:!!l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[l.username," ",l.phoneNumber]}),e.jsxs(c,{children:[e.jsx("div",{children:l.address.join(" ")}),e.jsx("div",{className:s.btn,children:"修改"})]})]})}),e.jsxs(c,{size:"3rem",children:[e.jsx(m,{outlined:!0,className:s.btn_back,onClick:()=>{n(-1)},children:"返回购物车"}),e.jsx(m,{loading:a,onClick:()=>{l?(o(!0),setTimeout(()=>{n("/orders/pay",{replace:!0})},1e3)):g.alert("请选择地址")},children:"立即下单"})]})]})}export{ee as default};
