import{M as y,j as t,R as b,S as g,L as d,B as j,c as _,f as E,C as N,N as w,b as L,Q as I,y as v,z as x,T as P,U as $,W as S,X as A,r as C,m as M,P as R,Y as z,Z as U}from"./index-ad9c4655.js";import{C as B}from"./index-845b07b1.js";import{M as D}from"./index-0d988fe9.js";import{C as k}from"./index-66b37b56.js";import{u as F}from"./useElementVisible-601d338f.js";import"./index-62a9780a.js";import"./index-e1217070.js";const H="_container_wjh0j_1",T="_content_wjh0j_4",V="_tips_wjh0j_8",X="_desc_wjh0j_13",O="_btn_group_wjh0j_16",Q="_btn_wjh0j_16",W="_outlined_wjh0j_23",o={container:H,content:T,tips:V,desc:X,btn_group:O,btn:Q,outlined:W};function Y(){const n=y();return t.jsxs(b,{align:"middle",justify:"center",className:o.container,children:[t.jsx("img",{src:"https://cdn.cnbj1.fds.api.mi-img.com/staticsfile/cart/cart-empty.png",alt:"empty cart",draggable:!1}),t.jsxs("div",{className:o.content,children:[t.jsx("div",{className:o.tips,children:"您的购物车还是空的！"}),!n&&t.jsx("div",{className:o.desc,children:"登录后将显示您之前加入的商品"}),t.jsx("div",{className:o.btn_group,children:n?t.jsx(d,{to:"/search",children:t.jsx(j,{className:o.btn,children:"马上去购物"})}):t.jsxs(g,{size:"1rem",children:[t.jsx(d,{to:"/auth/login",state:{pathname:"/cart"},children:t.jsx(j,{className:o.btn,children:"立即登录"})}),t.jsx(d,{to:"/search",children:t.jsx(j,{outlined:!0,className:_(o.btn,o.outlined),children:"马上去购物"})})]})})]})]})}const Z="_container_j97t8_1",q={container:Z},G="_container_1ug42_1",J="_input_1ug42_9",K="_icon_1ug42_17",p={container:G,input:J,icon:K};function tt({value:n,defaultValue:m=1,min:a=0,max:u=Number.MAX_VALUE,onChange:l}){const[i,e]=E(n,m,l);function c(r){r>=a&&r<=u&&e(r)}return t.jsxs("div",{className:p.container,children:[t.jsx(N,{type:"i-minus",className:p.icon,onClick:()=>{c(i-1)}}),t.jsx("input",{type:"number",value:i,className:p.input,onChange:r=>{const h=Number(r.target.value);Number.isInteger(h)&&h>=0&&c(h)}}),t.jsx(N,{type:"i-plus",className:p.icon,onClick:()=>{c(i+1)}})]})}const st="_container_1f02t_1",et="_product_list_1f02t_5",nt="_product_row_1f02t_8",ct="_title_1f02t_17",at="_col_check_1f02t_21",ot="_img_1f02t_25",it="_col_name_1f02t_30",lt="_col_price_1f02t_36",rt="_col_num_1f02t_40",_t="_col_total_1f02t_44",dt="_value_1f02t_48",mt="_col_action_1f02t_51",ut="_icon_1f02t_55",ht="_footer_bar_1f02t_60",jt="_fixed_1f02t_71",pt="_link_item_1f02t_75",xt="_danger_1f02t_83",ft="_cart_total_1f02t_86",bt="_total_amount_1f02t_92",gt="_btn_order_1f02t_98",Nt="_disabled_1f02t_103",vt="_btn_tips_1f02t_108",s={container:st,product_list:et,product_row:nt,title:ct,col_check:at,img:ot,col_name:it,col_price:lt,col_num:rt,col_total:_t,value:dt,col_action:mt,icon:ut,footer_bar:ht,fixed:jt,link_item:pt,danger:xt,cart_total:ft,total_amount:bt,btn_order:gt,disabled:Nt,btn_tips:vt};function Ct(){return t.jsxs("div",{className:s.container,children:[t.jsx(kt,{}),t.jsx(yt,{})]})}function kt(){const n=w(),m=L(),[{allChecked:a,halfChecked:u},{switchCheck:l,removeItem:i}]=I();return t.jsxs("div",{className:s.product_list,children:[t.jsxs(b,{align:"middle",className:_(s.product_row,s.title),children:[t.jsx("div",{className:s.col_check,children:t.jsx(k,{checked:a,indeterminate:!a&&u,onChange:e=>{l(null,e)},children:t.jsx("span",{style:{marginLeft:"1rem"},children:"全选"})})}),t.jsx("div",{className:s.col_name,children:"商品名称"}),t.jsx("div",{className:s.col_price,children:"单价"}),t.jsx("div",{className:s.col_num,children:"数量"}),t.jsx("div",{className:s.col_total,children:"小计"}),t.jsx("div",{className:s.col_action,children:"操作"})]}),n.map(e=>t.jsxs(b,{align:"middle",className:s.product_row,children:[t.jsxs("div",{className:s.col_check,children:[t.jsx(k,{checked:e.checked,onChange:c=>{l(e,c)}}),t.jsx(d,{to:v(e.label),children:t.jsx("img",{alt:e.label,src:e.pictureUrl,className:s.img})})]}),t.jsx("div",{className:_(s.col_name,"text-ellipsis"),children:t.jsx(d,{to:v(e.label),children:e.label})}),t.jsx("div",{className:s.col_price,children:x(e.price)}),t.jsx("div",{className:s.col_num,children:t.jsx(tt,{value:e.number,onChange:c=>{c===0?i(e):m(P.actions.modifyProductNumber({label:e.label,number:c}))}})}),t.jsx("div",{className:_(s.col_total,s.value),children:x(new $(e.price).mul(e.number).toNumber())}),t.jsx("div",{className:s.col_action,children:t.jsx(S,{className:s.icon,onClick:()=>{i(e)}})})]},e.label))]})}function yt(){const n=w(),m=L(),{totalNumber:a,totalAmount:u}=A(),l=C.useRef(null),i=F(l,f=>f.bottom>=window.innerHeight,[n.length]),e=y(),c=M(),[r,h]=C.useState(!1);return t.jsxs("div",{ref:l,className:_(s.footer_bar,i&&s.fixed),children:[t.jsxs(g,{size:"1.6rem",split:t.jsx("span",{style:{color:"#eee"},children:"|"}),style:{marginLeft:"2.4rem"},children:[t.jsx(d,{to:"/search",className:s.link_item,children:"继续购物"}),t.jsx("div",{className:_(s.link_item,s.danger),onClick:()=>{R.confirm("确定清空购物车吗？",{onOk(){return new Promise(f=>{setTimeout(()=>{m(P.actions.clearCart()),f()},1e3)})}})},children:"清空购物车"}),t.jsxs("div",{className:s.cart_total,children:["已选择 ",t.jsx("span",{children:x(a,"")})," 件"]})]}),t.jsxs(g,{size:"5rem",children:[t.jsxs("div",{className:s.total_amount,children:["合计：",t.jsx("span",{children:x(u,"")})," 元"]}),t.jsxs("div",{children:[t.jsx(j,{loading:r,className:_(s.btn_order,a===0&&s.disabled),onClick:()=>{a>0&&(e?(h(!0),setTimeout(()=>{c("/orders/checkout")},1e3)):z(()=>{c("/auth/login",{state:{pathname:"/cart"}})}))},children:"去结算"}),a===0&&t.jsx(j,{outlined:!0,className:s.btn_tips,children:"请勾选需要结算的商品"})]})]})]})}function At(){const n=U();return t.jsxs(t.Fragment,{children:[t.jsx(D,{title:"我的购物车",extra:!n&&"温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算"}),t.jsx("div",{style:{backgroundColor:"var(--color-background)"},children:t.jsxs("div",{className:q.container,children:[n?t.jsx(Y,{}):t.jsx(Ct,{}),t.jsx(B,{title:n?"为您推荐":"买购物车中商品的人还买了"})]})})]})}export{At as default};
